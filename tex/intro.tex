\chapter{引言}

% DL-based CV技术在医学图像上，对计算机辅助医疗应用的意义（辅助诊断、初级工作、快速准确）
医学图像的理解与分析是计算机辅助临床诊断的一种重要形式。近年来，随着深度学习技术的广泛应用与显著效果，医学图像领域的各种技术也快速发展，加快了智能医疗的进程。作为一项基本课题，医学图像的语义分割对图像信息进行细粒度的感知和理解，提供重要的诊断论据。它可以作为先期诊断与辅助信息，实现自动医学诊断或辅助医生判断。在国家医疗资源整体短缺的情况下，自动的语义分割系统可以极大降低医生的工作量，快速提升效率，对整个医疗行业与社会具有深远意义。

% 图像的语义分割：任务描述，应用，数据标注的问题（标注不足，标签错误）
图像语义分割，是计算机视觉领域的一个基本任务，旨在生成像素级别的物体类别表示。换句话说，它是一种像素级别的分类任务，细粒度是其重要特点。它对目标物体（比如器官、组织、肿瘤等）进行完整的识别，提供目标物体的形状或体积的关键信息，在计算机辅助医学中有应用广泛。比如，对器官及所附肿瘤的分割结果，可以准确呈现病症乃至判断病型；血管的完整分割，能够作为手术操作依据；肠道的分割建模，能够快速定位病灶。
传统的图像语义分割根据图像的颜色空间、空间距离及纹理等特征进行处理，包括聚类分割、阈值分割、决策树分类、图割分割等方法。
随着深度学习技术，特别是卷积神经网络（convolutional neural network, CNN）在计算机视觉的广泛应用，语义分割技术迎来了新的大发展。深度神经网络可以从大量的标注数据中自动学习提取丰富的高阶语义特征，并基于提取出的特征进行推理，预测图像的像素级标签。以全卷积神经网络（fully convolutional network, FCN）为开端的一系列分割工作，极大提高了该任务的准确度与应用场景的广泛性。

训练基于深度学习的分割模型，通常需要一个较大的数据集，并且依赖大量像素级别的标注（能够准确地划分出物体边界）。然而，在医学领域，由于缺乏有经验的注释者和物体边界的视觉模糊性，获得这种高质量的注释往往是困难的。并且，像素级别的标注也是非常昂贵和耗时的。极高的标注成本提高了语义分割方法落地的难度，也限制了其应用范围的广度。因此，如何降低标注难度和成本是一个实践中非常关心的问题。为了降低标注成本，我们探索两个方向：一，放弃要求较高的全标注，采用弱标注方式，并探索对应的基于弱标注的高效的分割方法，即弱监督语义分割问题；二，采用初级标注者的噪声标签，探索具有处理噪声能力的鲁棒的分割方法，即有噪声标签的语义分割问题（该任务也可看做弱监督）。
这两个方向探索的目标都是，在有限条件的数据标注下，尽可能提高分割效果，以接近基于完整准确标注方法（即全监督语义分割）的上限。

% 弱监督语义分割：问题转化、目标与实际意义
弱监督语义分割是基于弱标注方法，即一些简单形式的标注方式，比如边界框、涂鸦式标签、点标签等，来进行图像分割模型的学习。
由于弱标注提供的标签信息远少于全标注，语义信息有限，所以直接应用现有分割方法的输出精度较低。故而，如何利用提高弱监督语义分割方法的效果，是一个研究热点。
在弱监督语义分割上的探索，实质上是采用各种技术来弥补数据不足带来的效果下降，一种较好的弱监督分割方法，能够广泛应用到各种数据不足的场景，解决实际中的数据难题，对扩大深度学习技术的应用场景有重大意义。

% 有噪声标签的语义分割：问题定义、目标和实际意义
有噪声标签的语义分割，是指训练数据中有一定比例的错误标签。噪声标签会直接干扰神经网络的学习能力，降低模型的分割效果。这个任务中的核心问题是如何识别并处理噪声标签，减少其对神经网络的影响。现实中由于数据收集的复杂性，噪声标签是很常见的，探索这一问题，可以高效利用这些已有的噪声标签。

% 弱监督工作的局限，引入形状先验的意义
在弱监督语义分割中，本文研究的重点是结合形状先验的分割方法。仅仅依靠标注的粗标签，能获取的信息是有限的。本文希望在弱监督语义分割中引入形状先验，来弥补训练标签的不足。
只把分割工作视为每个像素的分类任务，会忽略其整体的几何结构。在分割任务中，局部视角下确实每个像素都只利用其特征做分类，但在全局视角下物体有整体的形状。这种整体结构的建模与利用，能够作为先验信息，克服局部视角的错误或缺失，引导模型产生更准确完整的预测结果。
在医学图像领域，大多数物体都具有相对固定的形状，一类物体也都具有一定程度的形状相似性。利用好形状先验，能够高效地解决弱标签带来的挑战，生成更加准确的分割结果。

% Noisy工作的局限，引入结构先验与空间关系的意义
在有噪声标签的语义分割中，本文重新考虑训练中的基本样本单元，以利用分割任务中的像素间相关性和空间先验。
过去的许多工作，忽略了分割任务的特性，把每个像素看做独立同分布的样本来建模，这是不符合实际的。我们考虑使用更灵活的表示和训练策略，来捕捉分割中图像的底层特征与性质，从而更准确地利用和处理噪声标签。


\section{研究背景及意义}
% 医学图像语义分割 背景
在图像语义分割任务中，全监督学习技术已经取得了很多进展，达到了较高的精度。这是其后研究弱监督语义分割和有噪声标签的语义分割的基础。
\citet{Long}~针对传统神经网络要求固定尺寸的图像输入的问题，首次提出了接受任意尺寸输入的FCN。FCN~用全卷积层替换~CNN~输出端的全连接层，实现端对端的稠密预测。在此基础上，DeepLab~为了更精细的分割效果，在 CNN 的输出后使用全连接的条件随机场，以优化定位精度。更进一步，\citet{Ronneberger}~提出了一种编码器-解码器结构 U-Net，这种结构被广泛应用在医学图像上。U-Net~的编码器采用一系列的卷积层和下采样操作，逐级提取语义信息，解码器则是一系列的卷积层和上采样操作，逐级恢复图像细节。U-Net兼顾了分割精度与效率。

除了~2D~医学图像，医学图像领域也有许多~3D~形式的分割任务。3D~U-Net 扩展了 U-Net，主要通过 3D 卷积单元替换 2D 卷积单元完成。这样整个 3D 图像可以直接输入进模型，输出端预测得到 3D 分割结果。V-Net 则通过把残差连接引入卷积模块，并且用卷积层代替上采样和下采样的池化层，并提出 Dice loss 来克服类别不均衡，提高 3D 分割网络的表达能力与精度。

\citet{Isensee}~提出了 nnU-Net，这是目前提出的泛化性能最好的分割系统。它是一套鲁棒的自适应的框架，适用于大多数 2D 和 3D 图像，探索了自适应模型结构、前处理、训练和推理阶段的各种方案。

% 弱标注 related  背景
然而，全监督学习所需的标注成本很高，弱监督学习是降低标注成本的一种方法。近年来有很多工作对弱监督语义分割进行探索，并取得了相当地进展。
弱监督分割里的基本问题是，采用什么形式的弱标签，继而如何仅仅利用弱标签，来训练需要大量数据的神经网络。
\citet{Lin} 提出使用涂鸦（scribble）进行图片标注，并且设计了一种算法，可以用涂鸦标注监督训练语义分割卷积网络。该工作先设计一个图模型，以把涂鸦标签传播到未标注像素上，同时，利用传播后的标签学习一个全卷积网络，并反过来提供语义信息给图模型。
\citet{Alan} 探索使用边界框（bounding box）或图像级标签的标注方法，并提出了一种弱监督下的期望最大化（expectation maximization, EM）算法来训练语义分割模型。这种算法迭代地进行弱标注约束下的未知像素标签估计，和使用估计得到的标签优化分割神经网络。EM 算法在后续的工作中被广泛使用。

% 弱标注的挑战
尽管这些工作在分割效果上取得很大提高，但未能探索分割任务中的形状先验、结构先验等约束，容易生成不准确的物体形状。物体并不仅仅有局部视角下的特征，也有整体的连续性与形状，充分考虑局部特征与整体特征的结合，对提高分割效果及算法的鲁棒性泛化性，具有重要意义。
\citet{Tang} 采用基于正则化损失的弱监督方法，通过设计具有底层分割特性的正则项，来隐式地实现分割网络对底层特征的关注。这种正则项损失采用了马尔可夫随机场和条件随机场的形式。
\citet{Kervadec} 探索在边界框的弱标注方法上，在模型中引入一些全局约束条件，包括框内的紧致性先验和框外的全背景先验。这些约束条件被转化融合进损失函数中进行优化。
由于这些工作对先验的表达不足，或者依赖于特定的标注形式与超参数，有一定局限性。在弱监督分割中结合物体形状先验，仍然是一个需要探索的方向。

% 有噪声标注 related
有噪声标签的语义分割考虑另一种情况：标签中有一定比例的错误。错误标签如果不做处理，会直接损害神经网络的效果。近来一些工作借鉴分类任务的工作，对这一领域进行了探索。
\citet{Zhu} 提出一种标签评估网络来自动评估标签质量，同时训练评估网络和分割网络，来自动重调整损失函数，以减轻错误标签对网络的负面影响。
\citet{Zhang} 设计了一种三网络同步学习的框架，用任两个网络来选择有价值的样本给另一个网络，这种同步训练并相互学习的方式克服了单网络容易过拟合的缺点。
% 有噪声标注的挑战
然而，这些工作在利用正确标签的方法上仍有不足，忽略了分割区域中的特征关系与空间结构，并且对分割网络的学习方式不够鲁棒。在这些方面的探索，依旧存在挑战性。

\section{本文研究内容}
本文研究根据分割任务的特点，分别探讨引入形状先验在弱监督语义分割中的作用，和基于图像底层特征表示的有噪声标签的学习方法。本节分别讨论弱监督语义分割任务和有噪声标签的语义分割任务中现有的挑战与不足，根据我们的对比观察给出相应的思考。然后基于这些思考，我们提出了自己的解决方法。对于弱监督语义分割，我们用自学习的方法捕捉到物体的形状先验，以解决弱监督下分割形状的缺陷；对于有噪声标签的语义分割，我们利用超像素作为基本表示单元，并基于它进行模型更新和标签更新，以解决噪声标签的干扰问题。最后，我们总结了本文在这两个任务的主要贡献，并探索了形状先验、结构特征对于有限标注的语义分割的重要性。

\subsection{弱监督语义分割}
弱监督语义分割任务，旨在探索基于弱标签的鲁棒的语义分割方法，以较少的标注成本达到较好的分割效果。本部分主要关注三维图像的语义分割，因为现实世界中，很多医学图像都是三维形态的（比如CT、MRI等），而很多工作已经探索过二维图像，却对三维图像探索得较少，我们尝试弥补这方面的不足。
在弱监督的三维图像语义分割领域，近来有很多工作采用把三维图像拆分成一系列二维图像的策略。然而，这些基于二维的方法，虽然取得了不错的效果，但应用在三维图像时有以下局限。首先，它们只是将生成的二维掩膜堆叠在一起作为最终输出，因此往往会产生不准确的物体形状（~\cite{Kervadec等人，2019，2020}）。此外，他们忽略了分割物体在三维空间中的连续性，并且无法利用连续的二维切片之间的标签相关性。由于这些限制与不足，在给定足够的三维样本和较小的片间间距条件下（Baumgartner等人，2017），二维方法往往比三维方法的表现要差。更进一步，现有的多数弱标注形式并不高效，无法为学习医学图像中的物体形状先验提供较好的指引。

在本文中，我们提出了一种新的三维物体分割的弱监督学习策略，以解决上述的挑战。我们的主要想法包括两个方面。首先，我们提出了一种自学习方法，通过物体样本增强的方法，来捕捉目标物体类别的三维形状先验。随后，我们将这种学习到的形状先验纳入具有形状感知的分割网络的训练过程。另外，我们采用了一个稀疏的弱标注方案，以更好地利用物体掩膜的空间连续性，并在不增加整体标注成本的情况下促进形状上下文的学习。

%%%
为了实现这一目标，我们设计了一个由两个主要模块组成的深度神经网络：一个是语义分割网络（SSN），它从输入图像中产生一个初始的三维分割掩码；另一个是形状去噪网络（SDN），它对初始掩码进行重新定义并输出一个最终的体积分割图。为了训练深度网络，我们首先引入了一个稀疏的弱注释方案，在该方案中，我们注释了一个特定的二维图像切片子集，并设计了一个混合标签，整合了前景涂鸦和目标物体的松散边界框。考虑到弱标签，我们为我们的网络模型开发了一个迭代学习框架，在像素级标签生成和网络参数更新之间交替进行。


\subsection{有噪声标签的语义分割}




\subsection{主要贡献}


\section{本文结构}

